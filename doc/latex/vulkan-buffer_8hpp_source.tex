\hypertarget{vulkan-buffer_8hpp_source}{}\doxysection{vulkan-\/buffer.hpp}
\label{vulkan-buffer_8hpp_source}\index{C:/Users/mmurrell/repos/axiom/components/render/vulkan/vulkan-\/buffer.hpp@{C:/Users/mmurrell/repos/axiom/components/render/vulkan/vulkan-\/buffer.hpp}}
\mbox{\hyperlink{vulkan-buffer_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{*\ Vulkan\ buffer\ class}}
\DoxyCodeLine{00003\ \textcolor{comment}{*}}
\DoxyCodeLine{00004\ \textcolor{comment}{*\ Encapsulates\ a\ Vulkan\ buffer}}
\DoxyCodeLine{00005\ \textcolor{comment}{*}}
\DoxyCodeLine{00006\ \textcolor{comment}{*\ Copyright\ (C)\ 2016\ by\ Sascha\ Willems\ -\/\ www.saschawillems.de}}
\DoxyCodeLine{00007\ \textcolor{comment}{*}}
\DoxyCodeLine{00008\ \textcolor{comment}{*\ This\ code\ is\ licensed\ under\ the\ MIT\ license\ (MIT)\ (http://opensource.org/licenses/MIT)}}
\DoxyCodeLine{00009\ \textcolor{comment}{*/}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{comment}{//\#include\ "{}../pch.h"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <volk.h>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <assert.h>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <cstring>}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\#include\ "{}VulkanTools.h"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceaxiom}{axiom}}\ \{}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keyword}{namespace\ }vks}
\DoxyCodeLine{00022\ \ \ \ \ \{}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer}{Buffer}}}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ VkDevice\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a25943541a33d113030ec55a8c386e6fe}{device}};}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ VkBuffer\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_aa4508d403672b524b03a5d32b4c37ecc}{buffer}}\ =\ VK\_NULL\_HANDLE;}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ VkDeviceMemory\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a486c473201ec188067c6e50a5f1515c2}{memory}}\ =\ VK\_NULL\_HANDLE;}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ VkDescriptorBufferInfo\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a59b9e9c11cdf76999a42ec82778f3c8a}{descriptor}};}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \ \ \ \ VkDeviceSize\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a444c72d8d1d53a0a6aaa4febbfb8037d}{size}}\ =\ 0;}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ VkDeviceSize\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_abedc7f8f731f397b68a26c68a580be78}{alignment}}\ =\ 0;}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a6724f562d2c82b9c273d2ee36e7d551e}{mapped}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ VkBufferUsageFlags\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_ad04327cb8d014075f0910aa6b9c4726a}{usageFlags}};}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ VkMemoryPropertyFlags\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a031f7a0563310073533282f1a89f94de}{memoryPropertyFlags}};}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ VkResult\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a1e971b28b7b86578539744cfee382a5d}{map}}(VkDeviceSize\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a444c72d8d1d53a0a6aaa4febbfb8037d}{size}}\ =\ VK\_WHOLE\_SIZE,\ VkDeviceSize\ offset\ =\ 0)}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ vkMapMemory(\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a25943541a33d113030ec55a8c386e6fe}{device}},\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a486c473201ec188067c6e50a5f1515c2}{memory}},\ offset,\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a444c72d8d1d53a0a6aaa4febbfb8037d}{size}},\ 0,\ \&\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a6724f562d2c82b9c273d2ee36e7d551e}{mapped}});}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_ace0534704bee0703ae2edae2c498a8f8}{unmap}}()}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a6724f562d2c82b9c273d2ee36e7d551e}{mapped}})}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vkUnmapMemory(\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a25943541a33d113030ec55a8c386e6fe}{device}},\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a486c473201ec188067c6e50a5f1515c2}{memory}});}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a6724f562d2c82b9c273d2ee36e7d551e}{mapped}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ VkResult\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a8038697aa11e306d87ed72d2521d0620}{bind}}(VkDeviceSize\ offset\ =\ 0)}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ vkBindBufferMemory(\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a25943541a33d113030ec55a8c386e6fe}{device}},\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_aa4508d403672b524b03a5d32b4c37ecc}{buffer}},\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a486c473201ec188067c6e50a5f1515c2}{memory}},\ offset);}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a9d01347c5dbbb274bb77c1d2837630a4}{setupDescriptor}}(VkDeviceSize\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a444c72d8d1d53a0a6aaa4febbfb8037d}{size}}\ =\ VK\_WHOLE\_SIZE,\ VkDeviceSize\ offset\ =\ 0)}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a59b9e9c11cdf76999a42ec82778f3c8a}{descriptor}}.offset\ =\ offset;}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a59b9e9c11cdf76999a42ec82778f3c8a}{descriptor}}.buffer\ =\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_aa4508d403672b524b03a5d32b4c37ecc}{buffer}};}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a59b9e9c11cdf76999a42ec82778f3c8a}{descriptor}}.range\ =\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a444c72d8d1d53a0a6aaa4febbfb8037d}{size}};}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a1af225ce70b91c5bf51607b918f71136}{copyTo}}(\textcolor{keywordtype}{void}*\ data,\ VkDeviceSize\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a444c72d8d1d53a0a6aaa4febbfb8037d}{size}})}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert(\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a6724f562d2c82b9c273d2ee36e7d551e}{mapped}});}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memcpy(\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a6724f562d2c82b9c273d2ee36e7d551e}{mapped}},\ data,\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a444c72d8d1d53a0a6aaa4febbfb8037d}{size}});}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ VkResult\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a9f8962742039ac6fcfbefc04ede970f0}{flush}}(VkDeviceSize\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a444c72d8d1d53a0a6aaa4febbfb8037d}{size}}\ =\ VK\_WHOLE\_SIZE,\ VkDeviceSize\ offset\ =\ 0)}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VkMappedMemoryRange\ mappedRange\ =\ \{\};}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mappedRange.sType\ =\ VK\_STRUCTURE\_TYPE\_MAPPED\_MEMORY\_RANGE;}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mappedRange.memory\ =\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a486c473201ec188067c6e50a5f1515c2}{memory}};}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mappedRange.offset\ =\ offset;}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mappedRange.size\ =\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a444c72d8d1d53a0a6aaa4febbfb8037d}{size}};}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ vkFlushMappedMemoryRanges(\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a25943541a33d113030ec55a8c386e6fe}{device}},\ 1,\ \&mappedRange);}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ VkResult\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_ae904a8a78b148d07cd493f16541332e3}{invalidate}}(VkDeviceSize\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a444c72d8d1d53a0a6aaa4febbfb8037d}{size}}\ =\ VK\_WHOLE\_SIZE,\ VkDeviceSize\ offset\ =\ 0)}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VkMappedMemoryRange\ mappedRange\ =\ \{\};}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mappedRange.sType\ =\ VK\_STRUCTURE\_TYPE\_MAPPED\_MEMORY\_RANGE;}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mappedRange.memory\ =\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a486c473201ec188067c6e50a5f1515c2}{memory}};}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mappedRange.offset\ =\ offset;}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mappedRange.size\ =\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a444c72d8d1d53a0a6aaa4febbfb8037d}{size}};}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ vkInvalidateMappedMemoryRanges(\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a25943541a33d113030ec55a8c386e6fe}{device}},\ 1,\ \&mappedRange);}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a6450348cf0701c4a4c15283eac849e60}{destroy}}()}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_aa4508d403672b524b03a5d32b4c37ecc}{buffer}})}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vkDestroyBuffer(\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a25943541a33d113030ec55a8c386e6fe}{device}},\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_aa4508d403672b524b03a5d32b4c37ecc}{buffer}},\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a486c473201ec188067c6e50a5f1515c2}{memory}})}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vkFreeMemory(\mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a25943541a33d113030ec55a8c386e6fe}{device}},\ \mbox{\hyperlink{structaxiom_1_1vks_1_1_buffer_a486c473201ec188067c6e50a5f1515c2}{memory}},\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00164\ \ \ \ \ \}}
\DoxyCodeLine{00165\ \}}

\end{DoxyCode}
